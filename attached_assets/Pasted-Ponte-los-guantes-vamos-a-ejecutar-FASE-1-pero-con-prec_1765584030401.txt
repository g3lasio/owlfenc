Ponte los guantes, vamos a ejecutar FASE 1, pero con precisi贸n quir煤rgica y respetando estrictamente el plan aprobado.

CONTEXTO

El roadmap que propusiste est谩 bien pensado y queda aprobado, con cuatro ajustes clave que deben respetarse desde el inicio.
El objetivo es expandir el sistema, no refactorizar ni poner en riesgo nada de lo que ya funciona en producci贸n.

INSTRUCCIONES CLARAS PARA FASE 1
1锔 NO refactorizar el contrato actual

El Independent Contractor Agreement actual NO se toca.

No se extrae todav铆a a independent-contractor.ts.

Debe seguir funcionando exactamente igual.

El nuevo sistema de templates debe convivir en paralelo.

Si templateId no viene en el request, usa el flujo legacy actual sin cambios.

 La refactorizaci贸n del contrato existente se evaluar谩 m谩s adelante, no en esta fase.

2锔 Sistema de templates NUEVO, montado encima del core actual

Implementa:

Template Registry

TemplateService

Todos los documentos nuevos (Change Order, Addendum, etc.) deben:

Generar HTML propio

Pasar por el mismo pipeline existente de:

PDF

URLs de firma

Incrustaci贸n de firmas

Validaciones

Storage

锔 Bajo ninguna circunstancia se debe modificar:

El motor de PDF

El sistema de firmas

El flujo de URLs

El storage actual

3锔 Versionado desde el d铆a 1

templateVersion debe existir desde ahora, aunque sea "1.0".

Debe vivir:

En el registry

En el documento guardado (Firebase)

Esto es obligatorio para futuro legal y compatibilidad.

4锔 Firma flexible (preparar el terreno)

No usar solo requiresSignature: boolean.

Preparar el campo para algo como:

signatureType: 'none' | 'single' | 'dual'

No hace falta implementar toda la l贸gica ahora, pero la estructura debe quedar lista.

5锔 Feature Flags obligatorios

Implementar feature flags desde el inicio para:

Documentos complementarios

Selector de tipo de documento en UI

Debe ser posible:

Activar/desactivar Fase 1 sin redeploy

Probar internamente sin afectar usuarios actuales

ALCANCE EXACTO DE FASE 1 (NO MS)

Implementar documentos complementarios:

Change Order Agreement

Contract Addendum

Work Order / Statement of Work

Lien Waiver (Partial / Final)

Certificate of Completion

Warranty Agreement

Usar exactamente el mismo flujo existente de generaci贸n y firma.

UI: agregar selector de tipo de documento solo si est谩 protegido por feature flag.

Tests de regresi贸n obligatorios para confirmar:

Contratos legacy siguen funcionando id茅nticos.

PDFs y firmas no cambian.

LO QUE ESPERO DE TI

Ejecuta Fase 1 sin improvisar.

Sigue el roadmap aprobado.

No agregues features fuera de alcance.

Si algo no est谩 claro, pregunta antes de asumir.

Primero estabilidad.
Luego expansi贸n.
Luego perfecci贸n.

Avanza con Fase 1 bajo estas reglas.